GUIcd ('/media/mobsmorty/dataMOBS70/Souris 648-TG108/29112017/VLPO-sleep Baseline day3_171212_093259/')

set(0,'DefaultFigureWindowStyle','docked')
% get info about intan recording
read_Intan_RHD2000_file

%% Pour séparer le.dat de 2 souris
% RefSubtraction_multi('amplifier.dat',32,2,'M675',0:15,4,[],'M645',16:31,20,[]); %32=nombre de voies; %2=nombre de souris
% RefSubtraction_multi('amplifier.dat',32,2,'M675',0:15,4,[],'M645',16:31,20,[]);
%RefSubtraction_multi('amplifier.dat',71,2,'M1055',[0:31],8,[64,65,66,70],'M1052',[32:63],57,[67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',71,2,'M1052',[0:31],25,[64,65,66,70],'M1055',[32:63],40,[67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',71,2,'M1052',[0:31],25,[64,65,66,70],'M1055',[32:63],40,[67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',71,2,'M1055',[0:31],8,[64,65,66,70],'M1052',[32:63],57,[67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',71,2,'M1052',[0:31],25,[64,65,66,70],'M1055',[40],40,[32:39,41:63,67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',71,2,'M1052',[0:31],25,[64,65,66,70],'M1055',[40],40,[32:39,41:63,67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',36,1,'M1052',[0:31],25,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1076',[0:31],24,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1074',[0:31],24,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1075',[0:31],25,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1074',[8],8,[0:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1076',[0:31],24,[64,65,66,70],'M1055',[32:63],40,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1055',[8],8,[0:31,64,65,66,70],'M1075',[32:63],41,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1055',[0:31],8,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',71,1,'M1055',[8],8,[0:31,64,65,66]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1110',[10],10,[0:9,11:31,64,65,66,70],'M1109',[42],42,[32:41,43:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1109',[10],10,[0:9,11:31,64,65,66,70],'M1110',[32:63],42,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1110',[10],10,[0:9,11:31,64,65,66,70],'M1109',[42],42,[32:41,43:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1112',[8],8,[0:7,9:31,64,65,66,70],'M1111',[32:63],41,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1111',[9],9,[0:8,10:31,64,65,66,70],'M1112',[32:63],40,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1105',[22],22,[0:21,23:31,64,65,66,70],'M1106',[42],42,[32:41,43:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1105',[22],22,[0:21,23:31,64,65,66,70],'M1106',[42],42,[32:41,43:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',1,3,'M1105',[22],22,[0:21,23:31,96,97,98,105],'M1107',[40],40,[32:39,41:63,99,100,101,105],'M1106',[74],74,[64:73,75:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1109',[10],10,[0:9,11:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1105',[22],22,[0:21,23:31,128,129,130,140],'M1106',[42],42,[32:41,43:63,131,132,133,140],'M1107',[72],72,[64:71,73:95,134,135,136,140],'M1112',[104],104,[96:103,105:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1137',[0:31],8,[64,65,66,70],'M1136',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1136',[8],8,[0:7,9:31,64,65,66,70],'M1137',[32:63],40,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1075',[0:31],25,[96,97,98,105],'M1107',[40],40,[32:39,41:63,99,100,101,105],'M1112',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1105',[22],22,[0:21,23:31,128,129,130,140],'M1106',[42],42,[32:41,43:63,131,132,133,140],'M1107',[72],72,[64:71,73:95,134,135,136,140],'M1112',[104],104,[96:103,105:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1150',[0:31],8,[96,97,98,105],'M1149',[40],40,[32:39,41:63,99,100,101,105],'M1148',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1109',[10],10,[0:9,11:31,64,65,66,70],'M1137',[32:63],40,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1105',[0:31],24,[128,129,130,140],'M1106',[40],40,[32:39,41:63,131,132,133,140],'M1109',[74],74,[64:73,75:95,134,135,136,140],'M1137',[104],104,[96:103,105:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1148',[8],8,[0:7,9:31,64,65,66,70],'M1149',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1150',[0:31],8,[96,97,98,105],'M1149',[40],40,[32:39,41:63,99,100,101,105],'M1148',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1105',[22],22,[0:21,23:31,96,97,98,105],'M1107',[40],40,[32:39,41:63,99,100,101,105],'M1106',[74],74,[64:73,75:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1148',[0:31],8,[96,97,98,105],'M1149',[40],40,[32:39,41:63,99,100,101,105],'M1150',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1179',[8],8,[0:7,9:31,64,65,66,70],'M1180',[32:63],56,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1180',[0:31],24,[64,65,66,70],'M1179',[32:63],40,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1181',[8],8,[0:7,9:31,64,65,66,70],'M1180',[32:63],56,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1150',[0:31],8,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1197',[9],9,[0:8,10:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1196',[9],9,[0:8,10:31,96,97,98,105],'M1197',[41],41,[32:40,42:63,99,100,101,105],'M1198',[73],73,[64:72,74:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1196',[0:31],9,[64,65,66,70],'M1197',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1148',[8],8,[0:7,9:31,96,97,98,105],'M1149',[40],40,[32:39,41:63,99,100,101,105],'M1150',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1217',[8],8,[0:7,9:31,128,129,130,140],'M1218',[40],40,[32:39,41:63,131,132,133,140],'M1219',[73],73,[64:72,74:95,134,135,136,140],'M1220',[104],104,[96:103,105:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1217',[8],8,[0:7,9:31,64,65,66,70],'M1218',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1217',[8],8,[0:7,9:31,128,129,130,140],'M1207',[52],52,[32:51,53:63,131,132,133,140],'M1219',[73],73,[64:72,74:95,134,135,136,140],'M1220',[104],104,[96:103,105:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1148',[0:31],8,[96,97,98,105],'M1149',[40],40,[32:39,41:63,99,100,101,105],'M1150',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1237',[9],9,[0:8,10:31,64,65,66,70],'M1238',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1235',[9],9,[0:8,10:31,128,129,130,140],'M1236',[41],41,[32:40,42:63,131,132,133,140],'M1237',[73],73,[64:72,74:95,134,135,136,140],'M1238',[105],105,[96:104,106:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1219',[9],9,[0:8,10:31,64,65,66,70],'M1235',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1219',[9],9,[0:8,10:31,64,65,66,70],'M1220',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1245',[0:31],9,[96,97,98,105],'M1247',[32:63],40,[99,100,101,105],'M1248',[73],73,[64:72,74:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1245',[0:31],9,[96,97,98,105],'M1247',[32:63],40,[99,100,101,105],'M1248',[73],73,[64:72,74:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1237',[0:31],9,[32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1196',[9],9,[0:8,10:31,96,97,98,105],'M1237',[32:63],41,[99,100,101,105],'M1238',[73],73,[64:72,74:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1247',[0:31],8,[64,65,66,70],'M1248',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1245',[9],9,[0:8,10:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1245',[0:31],9,[96,97,98,105],'M1247',[32:63],40,[99,100,101,105],'M1248',[73],73,[64:72,74:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1245',[9],9,[0:8,10:31,128,129,130,140],'M1247',[41],41,[32:40,42:63,131,132,133,140],...
% 'M1254',[64:95],87,[134,135,136,140],'M1248',[105],105,[96:104,106:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1301',[9],9,[0:8,10:31,64,65,66,70],'M1303',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1300',[9],9,[0:8,10:31,128,129,130,140],'M1301',[41],41,[32:40,42:63,131,132,133,140],...
% 'M1302',[73],73,[64:72,74:95,134,135,136,140],'M1303',[105],105,[96:104,106:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1300',[9],9,[0:8,10:31,64,65,66,70],'M1302',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1301',[9],9,[0:8,10:31,64,65,66,70],'M1303',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1332',[9],9,[0:8,10:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1340',[9],9,[0:8,10:31,64,65,66,70],'M1332',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1332',[9],9,[0:8,10:31,64,65,66,70],'M1341',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1300',[9],9,[0:8,10:31,128,129,130,140],'M1301',[41],41,[32:40,42:63,131,132,133,140],...
% 'M1302',[73],73,[64:72,74:95,134,135,136,140],'M1303',[105],105,[96:104,106:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1367',[9],9,[0:8,10:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1370',[9],9,[0:8,10:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1371',[9],9,[0:8,10:31,128,129,130,140],'M1372',[41],41,[32:40,42:63,131,132,133,140],...
% 'M1373',[73],73,[64:72,74:95,134,135,136,140],'M1374',[105],105,[96:104,106:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1373',[9],9,[0:8,10:31,64,65,66,70],'M1374',[42],42,[32:41,43:63,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',71,2,'M1388',[9],9,[0:8,10:31,64,65,66,70],'M1389',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1387',[9],9,[0:8,10:31,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1371',[8],8,[0:7,9:31,64,65,66,70],'M1372',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1373',[9],9,[0:8,10:31,64,65,66,70],'M1374',[42],42,[32:41,43:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1371',[8],8,[0:7,9:31,96,97,98,105],'M1372',[41],41,[32:40,42:63,99,100,101,105],...
%     'M1388',[73],73,[64:72,74:95,102,103,104,105]);
% 
% RefSubtraction_multi('amplifier.dat',71,2,'M1387',[9],9,[0:8,10:31,64,65,66,70],'M1388',[41],41,[32:40,42:63,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',36,1,'M1389',[8],8,[0:7,9:31,32,33,34,35]);
% 
% RefSubtraction_multi('amplifier.dat',71,2,'M1390',[9],9,[0:8,10:31,64,65,66,70],'M1387',[41],41,[32:40,42:63,67,68,69,70]);
% 
% RefSubtraction_multi('amplifier.dat',36,1,'M1390',[9],9,[0:8,10:31,32,33,34,35]);
% 
% RefSubtraction_multi('amplifier.dat',71,2,'M1390',[9],9,[0:8,10:31,64,65,66,70],'M1389',[40],40,[32:39,41:63,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',71,2,'M1247',[0:31],8,[64,65,66,70],'M1248',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1424',[8],8,[0:7,9:31,128,129,130,140],'M1423',[40],40,[32:39,41:63,131,132,133,140],'M1425',[72],72,[64:71,73:95,134,135,136,140],'M1426',[104],104,[96:103,105:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1424',[8],8,[0:7,9:31,64,65,66,70],'M1423',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1425',[8],8,[0:7,9:31,64,65,66,70],'M1426',[40],40,[32:39,41:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1433',[10],10,[0:9,11:31,96,97,98,105],'M1434',[32:63],40,[99,100,101,105],'M1435',[64:95],72,[102,103,104,105]);
% 
% RefSubtraction_multi('amplifier.dat',71,2,'M1389',[8],8,[0:7,9:31,64,65,66,70],'M1390',[57],57,[32:56,58:63,67,68,69,70]);
% 
% RefSubtraction_multi('amplifier.dat',71,2,'M1219',[9],9,[0:8,10:31,64,65,66,70],'M1235',[41],41,[32:40,42:63,67,68,69,70]);
% 
% RefSubtraction_multi('amplifier.dat',106,3,'M1433',[10],10,[0:9,11:31,96,97,98,105],'M1434',[32:63],40,[99,100,101,105],'M1435',[64:95],72,[102,103,104,105]);
% 
% RefSubtraction_multi('amplifier.dat',106,3,'M1449',[10],10,[0:9,11:31,96,97,98,105],'M1450',[42],42,[32:41,43:63,99,100,101,105],'M1451',[64:95],74,[102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1300',[9],9,[0:8,10:31,64,65,66,70],'M1302',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1301',[9],9,[0:8,10:31,64,65,66,70],'M1303',[41],41,[32:40,42:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1439',[22],22,[0:21,23:31,64,65,66,70],'M1440',[36],36,[32:35,37:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1437',[23],23,[0:23,24:31,96,97,98,105],'M1439',[54],54,[32:53,55:63,99,100,101,105],'M1440',[68],68,[64:67,69:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1417',[23],23,[0:22,24:31,96,97,98,105],'M1418',[36],36,[32:35,37:63,99,100,101,105],'M1448',[68],68,[64:67,69:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1196',[9],9,[0:8,10:31,64,65,66,70],'M1197',[41],41,[32:40,42:63,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',106,3,'M1414',[4],4,[0:3,5:31,96,97,98,105],'M1416',[36],36,[32:35,37:63,99,100,101,105],'M1437',[87],87,[64:86,88:95,102,103,104,105]);

% RefSubtraction_multi('amplifier.dat',106,3,'M1437',[23],23,[0:23,24:31,96,97,98,105],'M1439',[54],54,[32:53,55:63,99,100,101,105],'M1440',[68],68,[64:67,69:95,102,103,104,105]);

% RefSubtraction_multi('amplifier.dat',71,2,'M1415',[20],20,[0:19,21:31,64,65,66,70],'M1446',[36],36,[32:35,37:63,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',71,2,'M1488',[10],10,[0:9,11:31,64,65,66,70],'M1489',[32:63],42,[67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1510',[8],8,[0:7,9:31,128,129,130,140],'M1511',[40],40,[32:39,41:63,131,132,133,140],'M1512',[72],72,[64:71,73:95,134,135,136,140],'M1489',[96:127],106,[137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1510',[0:31],8,[128,129,130,140],'M1511',[40],40,[32:39,41:63,131,132,133,140],'M1512',[72],72,[64:71,73:95,134,135,136,140],'M1488',[106],106,[96:105,107:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1511',[8],8,[0:7,9:31,128,129,130,140],'M1510',[32:63],40,[131,132,133,140],'M1512',[72],72,[64:71,73:95,134,135,136,140],'M1488',[106],106,[96:105,107:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1511',[8],8,[0:7,9:31,96,97,98,105],'M1512',[32:63],40,[99,100,101,105],'M1488',[74],74,[64:73,75:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1510',[0:31],8,[96,97,98,105],'M1511',[40],40,[32:39,41:63,99,100,101,105],'M1512',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1510',[0:31],8,[96,97,98,105],'M1488',[40],40,[32:39,41:63,99,100,101,105],'M1489',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',141,4,'0',[0:31],0,[128,129,130,140],'M1510',[32:63],40,[131,132,133,140],'M1488',[74],74,[64:73,75:95,134,135,136,140],'M1489',[96:127],106,[137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',106,3,'M1510',[0:31],8,[96,97,98,105],'M1511',[32:63],40,[99,100,101,105],'M1512',[72],72,[64:71,73:95,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1488',[0:9,11:31],10,[10,64,65,66,70],'M1489',[32:41,43:63],42,[42,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',106,3,'M1519',[0:2,4:31],3,[3,96,97,98,105],'M1520',[32:34,36:63],35,[35,99,100,101,105],'M1522',[64:66,68:95],67,[67,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1521',[0:2,4:31],3,[3,64,65,66,70],'M1523',[32:34,36:63],35,[35,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',71,2,'M1540',[0:4,6:31],5,[5,64,65,66,70],'M1543',[32:37,39:63],38,[38,67,68,69,70]); %Baseline du 03/01/24
% RefSubtraction_multi('amplifier.dat',36,1,'M1540',[0:4,6:31],5,[5,32,33,34,35]); %SD du 04/01/24
% RefSubtraction_multi('amplifier.dat',141,4,'M1539',[0,2:31],1,[1,128,129,130,140],'M1541',[54],54,[32:53,55:63,131,132,133,140],'M1542',[64:67,69:95],68,[68,134,135,136,140],'M1543',[96:101,103:127],102,[102,137,138,139,140]); %Baseline du 08/01/24
% RefSubtraction_multi('amplifier.dat',71,2,'M1539',[0,2:31],1,[1,64,65,66,70],'M1541',[54],54,[32:53,55:63,67,68,69,70]); %SD du 09/01/24
% RefSubtraction_multi('amplifier.dat',141,4,'M1539',[0,2:31],1,[1,128,129,130,140],'M1540',[32:36,38:63],37,[37,131,132,133,140],'M1541',[86],86,[64:85,87:95,134,135,136,140],'M1542',[96:99,101:127],100,[100,137,138,139,140]); %Baseline du 05/01/24
% RefSubtraction_multi('amplifier.dat',71,2,'M1542',[0:3,5:31],4,[4,64,65,66,70],'M1543',[32:37,39:63],38,[38,67,68,69,70]); %SD du 11/01/24
% RefSubtraction_multi('amplifier.dat',106,3,'M1539',[0,2:31],1,[1,96,97,98,105],'M1540',[32:36,38:63],37,[37,99,100,101,105],'M1541',[],[],[64:95,102,103,104,105]); %SD2 du 18/01/24

% RefSubtraction_multi('amplifier.dat',141,4,'M1566',[0,2:31],1,[1,128,129,130,140],'M1567',[33:63],32,[32,131,132,133,140],'M1568',[64:66,68:95],67,[67,134,135,136,140],'M1569',[96,98:127],97,[97,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1566',[0,2:31],1,[1,128,129,130,140],'M1567',[33:63],32,[32,131,132,133,140],'M1568',[],[],[64:95,134,135,136,140],'M1569',[96,98:127],97,[97,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1566',[],[],[0:31,128,129,130,140],'M1567',[],[],[32:63,131,132,133,140],'M1568',[],[],[64:95,134,135,136,140],'M1569',[],[],[96:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1566',[0,2:31],1,[1,64,65,66,70],'M1567',[33:63],32,[32,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1568',[0:2,4:31],3,[3,64,65,66,70],'M1569',[32,34:63],33,[33,67,68,69,70]);

% RefSubtraction_multi('amplifier.dat',141,4,'M1578',[1:31],0,[0,128,129,130,140],'M1579',[33:63],32,[32,131,132,133,140],'M1580',[64:95],64,[64,134,135,136,140],'M1581',[97:127],96,[96,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1578',[1:31],0,[0,64,65,66,70],'M1579',[33:63],32,[32,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1580',[1:31],0,[0,64,65,66,70],'M1581',[33:63],32,[32,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1579',[1:31],0,[0,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1578',[1:31],0,[0,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1579',[1:31],0,[0,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1580',[1:31],0,[0,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1581',[1:31],0,[0,32,33,34,35]);

%RefSubtraction_multi('amplifier.dat',71,2,'M0001',[0:7,9:31],8,[8,64,65,66,70],'M0002',[32:39,41:63],40,[40,67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',71,2,'M0003',[0:7,9:31],8,[8,64,65,66,70],'M0007',[32:39,41:63],40,[40,67,68,69,70]);
%RefSubtraction_multi('amplifier.dat',106,3,'M4',[0:7,9:31],8,[8,96,97,98,105],'M8',[32:39,41:63],40,[40,99,100,101,105],'M9',[],[],[64:95,102,103,104,105]);
%RefSubtraction_multi('amplifier.dat',106,3,'M4',[0:7,9:31],8,[8,96,97,98,105],'M8',[32:39,41:63],40,[40,99,100,101,105],'M9',[],[],[64:95,102,103,104,105]);
%RefSubtraction_multi('amplifier.dat',141,4,'M2',[0:7,9:31],8,[8,128,129,130,140],'M3',[32:39,41:63],40,[40,131,132,133,140],'M4',[64:71,73:95],72,[64,134,135,136,140],'M5',[96:103,105:127],104,[104,137,138,139,140]);
%RefSubtraction_multi('amplifier.dat',141,4,'M1',[0:7,9:31],8,[8,128,129,130,140],'M7',[32:39,41:63],40,[40,131,132,133,140],'M8',[64:71,73:95],72,[64,134,135,136,140],'M9',[96:103,105:127],104,[104,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',36,1,'M5',[0:7,9:31],8,[8,32,33,34,35]);

% RefSubtraction_multi('amplifier.dat',106,3,'M1631',[0:9,11:31],10,[10,96,97,98,105],'M1638',[32:41,43:63],42,[42,99,100,101,105],'M1639',[64:74,76:95],75,[75,102,103,104,105]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1634',[0:11,13:31],12,[12,128,129,130,140],'M1635',[32:43,45:63],44,[44,131,132,133,140],'M1636',[64:75,77:95],76,[76,134,135,136,140],'M1637',[],[],[96:127,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',36,1,'M1631',[0:9,11:31],10,[10,32,33,34,35]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1638',[0:9,11:31],10,[10,64,65,66,70],'M1639',[],[],[32:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1634',[0:11,13:31],12,[12,64,65,66,70],'M1635',[32:43,45:63],44,[44,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1634',[0:11,13:31],12,[12,64,65,66,70],'M1635',[],[],[32:63,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1636',[0:11,13:31],12,[12,64,65,66,70],'M1637',[],[],[32:63,67,68,69,70]);


% RefSubtraction_multi('amplifier.dat',71,2,'M1667',[0:9,11:31],10,[10,64,65,66,70],'M1668',[32:42,44:63],43,[43,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',141,4,'M1674',[0:12,14:31],13,[13,128,129,130,140],'M1675',[32:43,45:63],44,[44,131,132,133,140],'M1667',[64:73,75:95],74,[74,134,135,136,140],'M1668',[96:106,108:127],107,[107,137,138,139,140]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1674',[0:12,14:31],13,[13,64,65,66,70],'M1675',[32:43,45:63],44,[44,67,68,69,70]);
% RefSubtraction_multi('amplifier.dat',71,2,'M1676',[0:12,14:31],13,[13,64,65,66,70],'M1677',[32:43,45:63],44,[44,67,68,69,70]);


RefSubtraction_multi('amplifier.dat',106,3,'M1693',[],[],[0:31,96,97,98,105],'M1694',[32:44,46:63],45,[45,99,100,101,105],'M1695',[64:75,77:95],76,[76,102,103,104,105]);

%% Make your .xls file
%% Make your .xml file for LFP amplifier.xml %% Baseline sleep
%% Make your .xml file for spike amplifier_SpikeRef.xml
%% Add your mouse to CallRefFunction_Thierry and CallRefFunctionSpikes_Thierry

%%if ExpeInfo.nmouse==648
%%RefSubtraction_multi('amplifier.dat',16,1,'M648',0:15,4,[]);
% elseif ExpeInfo.nmouse==649
%     RefSubtraction_multi('amplifier.dat',16,1,'M649',0:15,7,[]);
% etc...

% Get all the info you need

GetBasicInfoRecord_Thierry
GetMouseInfo_Thierry
% change the info in CallRefFunction_Thierry
%%if ExpeInfo.nmouse==648
%%RefSubtraction_multi('amplifier.dat',16,1,'M648',0:15,4,[]);
% elseif ExpeInfo.nmouse==649
% RefSubtraction_multi('amplifier.dat',16,1,'M649',0:15,7,[]);
% etc...

% call in terminal all the preprocessing codes
ExecuteNDM_Thierry
% appelle toutes les fonction Preprocessing
% merge toutes les digin en une 
% fusion avec amplifier.dat
% filtrage divers
% sampling de 20000 Hz à 1250Hz
% va chercher les infos accelero / analogique / fichier spikes pour la PCA

%% check your files
SetCurrentSession

%% dans terminal
%%KlustaKwiknew M648_12122017_BaselineSleep_SpikeRef 1   

MakeData_Main_Thierry
% create matlab compatible files

%% sleep scoring
% SleepScoringOBGamma
SleepScoring_Accelero_OBgamma


%% Low Spectrums
Faire_les_Low_Spectrum

% Fonction pour trier les stim en fonction des états
% Start= nombre de stim dans le REM à 0 sec
% Mid = nombre de stim dans le REM à 30 sec (défini par la digin)
% End = nombre de stim dans le REM à 60 sec 
Nb_Start_Mid_End_Stim_dans_REM

% défini pour chaque stim les états avant et après  
[Result] = Analyse_Stim_Ap()
%%défini les transitions
[TransREMSWS,TransSWSREM,TransSWSWake,TransSWSSWS,TransSWSNoise,TransREMWake,TransREMNoise,TransREMREM,TransWakeSWS,TransWakeREM,TransWakeNoise,TransWakeWake,TransNoiseSWS,TransNoiseREM, TransNoiseWake,TransNoiseNoise] = Ordered_Analyse_Stim_Ap(Result)

%% Figures
FiguresID_V1

%%% Parcours figures avec toutes les stim dans le REM:
%%% AJOUTER LES NUITS DANS LES PATH DES PARCOURS
[MatTotal,MatCellArray,timeREM,vectTotal,vect,tps2]=ParcoursTransitionSleepOptoV2AllStim

[MatTotal,MatCellArray,timeREM,vectTotalB,vect,tps2]=ParcoursTransitionSleepBaselineSimulatedV2AllStim




