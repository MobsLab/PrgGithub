clear all
181014-181021-181019
% Directory Path
a=1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181103';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181102';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181027';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181026';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181025';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181024';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181021';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181020';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181019';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181018';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181017';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181014';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181013';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181012';a=a+1;
DirPath_R18{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat18/181011';a=a+1;
%
a=1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190213';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190214';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190224';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190226';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190227';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190228';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190302';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190303';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190307';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190308';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190309';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190313';a=a+1;
DirPath_R19{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat19/190314';a=a+1;

a=1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201230';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201229';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201228';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201227';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201226';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201223';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201222';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201221';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201220';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/201219';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200309';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200308';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200303';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200302';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200301';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200228';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200227';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200224';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200223';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200222';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200216';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200214';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200213';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200210';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200209';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200208';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200206';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200203';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200131';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200130';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200127';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200126';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200125';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200124';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200119';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200118';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200116';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200112';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200111';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200110';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200109';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200107';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200106';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200105';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200104';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200103';a=a+1;
DirPath_R20{a}='/media/2E3B0B762A23E6AB/DataExt3/Data/Rat20/200102';a=a+1;

%--------------------------------------------------------------------------
%--------------------------------------------------------------------------
%--------------------------------------------------------------------------

for day=1:length(DirPath_R18)
    cd(DirPath_R18{day})
    clear B C S Ssws NumNeurons
    load SpikeData
    %load SleepStages
    %SWSEpoch=sleep1DeltaEpoch{1,1};
    %Ssws=Restrict(S,SWSEpoch);
    Ssws=S;
    
    numNeurons=[];
    for i=1:length(S);
        numNeurons=[numNeurons,i];
    end
    NumNeurons=numNeurons;
    
    k=1;b=1;
    
    clear NumNeuronsOK
    for i=1:length(NumNeurons)
        if str2num(cellnames{NumNeurons(i)}(length(cellnames{NumNeurons(i)})))>1
            NumNeuronsOK(b)=NumNeurons(i);
            b=b+1;
        end
    end
    
    %--------------------------------------------------------------------------
    
    % Solist or Corist Analysis
    for i=1:length(NumNeuronsOK)
        num=1:length(NumNeuronsOK);
        num(i)=[];
        [C(k,:),B]=CrossCorr(Range(Ssws{NumNeuronsOK(i)}),Range(poolNeurons(Ssws,NumNeuronsOK(num))),10,500);
        C(k,:)=SmoothDec(C(k,:),0.2);
        
        temp=zscore(C(k,:));
        k=k+1;
    end
    
    % Zscore analysis
    Cz=zscore(C')';
    [h,b]=hist(Cz(:,252),50);
    
    %--------------------------------------------------------------------------
    %--------------------------------------------------------------------------
    %--------------------------------------------------------------------------
    
    figure('color',[1 1 1]), subplot(2,1,1), imagesc(B/1E3,1:size(C,1),zscore(C')'), xlim([-0.5 0.5]), title([pwd,'   ','# n=',num2str(length(S)),'neurons'])
    subplot(2,1,2), plot(B/1E3,zscore(C')), xlim([-0.5 0.5])
    
end


