% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
a=0;
a=a+1; Path_M243_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150222/Breath-Mouse-243-244-22022015/Mouse243';
%a=a+1; Path_M243_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150329/Electrophy/Breath-Mouse-243-244-29032015/Mouse243';
a=a+1; Path_M243_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150331/Electrophy/Breath-Mouse-243-244-31032015/Mouse243';
a=a+1; Path_M243_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150401/Breath-Mouse-243-244-01042015/Mouse243';
a=a+1; Path_M243_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150409/Breath-Mouse-243-244-09042015/Mouse243';

a=0;
a=a+1; Path_M244_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150222/Breath-Mouse-243-244-22022015/Mouse244';
%a=a+1; Path_M244_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150329/Electrophy/Breath-Mouse-243-244-29032015/Mouse244';
a=a+1; Path_M244_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150331/Electrophy/Breath-Mouse-243-244-31032015/Mouse244';
a=a+1; Path_M244_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150401/Breath-Mouse-243-244-01042015/Mouse244';
a=a+1; Path_M244_basal{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150409/Breath-Mouse-243-244-09042015/Mouse244';

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
a=0;
a=a+1; Path_M243_Rdm{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150416/Breath-Mouse-243-244-16042015/Mouse243';  % 16-04-2015 > random tone effect
a=a+1; Path_M243_Rdm{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150223/Breath-Mouse-243-244-23022015/Mouse243';  % 23-02-2015 > random tone effect

a=0;
a=a+1; Path_M244_Rdm{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150417/Breath-Mouse-243-244-17042015/Mouse244';  % 17-04-2015 > random tone effect
a=a+1; Path_M244_Rdm{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150223/Breath-Mouse-243-244-23022015/Mouse244';  % 23-02-2015 > random tone effect

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
a=0;
a=a+1; Path_M243_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150421/Breath-Mouse-243-21042015';               % 21-04-2015 > delay 140ms
a=a+1; Path_M243_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150417/Breath-Mouse-243-244-17042015/Mouse243';  % 17-04-2015 > delay 200ms
a=a+1; Path_M243_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150423/Breath-Mouse-243-23042015';               % 23-04-2015 > delay 320ms
a=a+1; Path_M243_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150425/Breath-Mouse-243-25042015';               % 25-04-2015 > delay 480ms
a=a+1; Path_M243_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150429/Breath-Mouse-243-29042015';               % 25-04-2015 > delay 3*140ms

a=0;
a=a+1; Path_M244_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150422/Breath-Mouse-244-22042015';               % 22-04-2015 > delay 140ms
a=a+1; Path_M244_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150416/Breath-Mouse-243-244-16042015/Mouse244';  % 16-04-2015 > delay 200ms
a=a+1; Path_M244_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150424/Breath-Mouse-244-24042015';               % 24-04-2015 > delay 320ms
a=a+1; Path_M244_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150426/Breath-Mouse-244-26042015';               % 26-04-2015 > delay 480ms
a=a+1; Path_M244_Delta{a}='/media/DataMOBsRAID/ProjetBreathDeltaFeedback/Mice243-244/20150430/Breath-Mouse-244-30042015';               % 30-04-2015 > delay 3*140ms
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                       LOAD  EPOCH & DELTA for BASAL SLEEP
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
try 
    struc
catch
    struc='PaCx';
end

% <><><><><><><><><><><><><><>  Mouse 243 : basal sleep <><><><><><><><><><><><><><>
for a=1:length(Path_M243_basal)
    cd(Path_M243_basal{a})
    res=pwd;
    
    % define 5 successive Sleep epochs
    try
        load EpochAnalysed
    catch
        load StateEpochSB SWSEpoch REMEpoch
        startSleep=Start(SWSEpoch);startSleep=startSleep(1); % start of first SWS episode
        endSleep=Stop(SWSEpoch);endSleep=endSleep(end);      % end of last SWS episode
        DurSWSEpoch=endSleep-startSleep;                     % total duration of sleeping recording
        for i=1:5
            EpochAnalysed{i}=intervalSet(startSleep+((DurSWSEpoch/5)*(i-1)),startSleep+((DurSWSEpoch/5)*(i)));
        end
        save EpochAnalysed EpochAnalysed
    end
    
    % restrict Delta occurence to the 5 succesive Sleep epochs
    load([res,'/newDelta',struc]);
     load StateEpochSB SWSEpoch REMEpoch
    for i=1:5
        Delta_M243_basal{a,i}=Restrict(ts(tDelta),EpochAnalysed{i});
        DurSWSEpoch_M243_basal{a,i}=tot_length(and(SWSEpoch,EpochAnalysed{i}),'s');
        DurREMEpoch_M243_basal{a,i}=tot_length(and(REMEpoch,EpochAnalysed{i}),'s');
        Dur5Epoch_M243_basal{a,i}=tot_length(EpochAnalysed{i},'s');
        RatioSWS_M243_basal{a,i}=DurSWSEpoch_M243_basal{a,i}/Dur5Epoch_M243_basal{a,i};
        RatioREM_M243_basal{a,i}=DurREMEpoch_M243_basal{a,i}/Dur5Epoch_M243_basal{a,i};
    end
end

% <><><><><><><><><><><><><><>  Mouse 244 : basal sleep <><><><><><><><><><><><><><>
for a=1:length(Path_M244_basal)
    cd(Path_M244_basal{a})
    res=pwd;
    
    % define 5 successive Sleep epochs
    try
        load EpochAnalysed
    catch
        load StateEpochSB SWSEpoch REMEpoch
        startSleep=Start(SWSEpoch);startSleep=startSleep(1); % start of first SWS episode
        endSleep=Stop(SWSEpoch);endSleep=endSleep(end);      % end of last SWS episode
        DurSWSEpoch=endSleep-startSleep;                     % total duration of sleeping recording
        for i=1:5
            EpochAnalysed{i}=intervalSet(startSleep+((DurSWSEpoch/5)*(i-1)),startSleep+((DurSWSEpoch/5)*(i)));
        end
        save EpochAnalysed EpochAnalysed
    end
    
    % restrict Delta occurence to the 5 succesive Sleep epochs
    load([res,'/newDelta',struc]);
     load StateEpochSB SWSEpoch REMEpoch
    for i=1:5
        Delta_M244_basal{a,i}=Restrict(ts(tDelta),EpochAnalysed{i});
        DurSWSEpoch_M244_basal{a,i}=tot_length(and(SWSEpoch,EpochAnalysed{i}),'s');
        DurREMEpoch_M244_basal{a,i}=tot_length(and(REMEpoch,EpochAnalysed{i}),'s');
        Dur5Epoch_M244_basal{a,i}=tot_length(EpochAnalysed{i},'s');
        RatioSWS_M244_basal{a,i}=DurSWSEpoch_M244_basal{a,i}/Dur5Epoch_M244_basal{a,i};
        RatioREM_M244_basal{a,i}=DurREMEpoch_M244_basal{a,i}/Dur5Epoch_M244_basal{a,i};
    end
end

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                       LOAD  EPOCH & DELTA for RANDOM TONE SLEEP
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><>  Mouse 243 : random tone sleep <><><><><><><><><><><><><><> 
for a=1:length(Path_M243_Rdm)
    cd(Path_M243_Rdm{a})
    res=pwd;
    
    % find Delta triggered session
    try
        load EpochAnalysed
    catch
        load behavResources
        b=1;
        for i=1:length(evt)/2
            textt=evt(i);
            if ~isempty(strfind(evt{i},'Delta'))
                DeltaSession(b)=i;
                b=b+1;
            elseif ~isempty(strfind(evt{i},'Tone'))
                ToneSession(b)=i;
                b=b+1;
            end
        end
        if exist DeltaSession
            EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{DeltaSession(1)}*1E4);
            EpochAnalysed{2}=intervalSet(tpsdeb{DeltaSession(1)}*1E4,tpsfin{DeltaSession(2)}*1E4);
            EpochAnalysed{3}=intervalSet(tpsfin{DeltaSession(2)}*1E4,tpsdeb{DeltaSession(3)}*1E4);
            EpochAnalysed{4}=intervalSet(tpsdeb{DeltaSession(3)}*1E4,tpsfin{DeltaSession(3)}*1E4);
            EpochAnalysed{5}=intervalSet(tpsfin{DeltaSession(3)}*1E4,tpsfin{end}*1E4);
            clear DeltaSession
            save EpochAnalysed EpochAnalysed
        elseif exist ToneSession
            EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{ToneSession(1)}*1E4);
            EpochAnalysed{2}=intervalSet(tpsdeb{ToneSession(1)}*1E4,tpsfin{ToneSession(1)}*1E4);
            EpochAnalysed{3}=intervalSet(tpsfin{ToneSession(1)}*1E4,tpsdeb{ToneSession(2)}*1E4);
            EpochAnalysed{4}=intervalSet(tpsdeb{ToneSession(2)}*1E4,tpsfin{ToneSession(2)}*1E4);
            EpochAnalysed{5}=intervalSet(tpsfin{ToneSession(2)}*1E4,tpsfin{end}*1E4);
            clear ToneSession
            save EpochAnalysed EpochAnalysed
        end
    end
   
    % restrict Delta occurence to the 5 succesive Sleep epochs 
    load([res,'/newDelta',struc]);
    load StateEpochSB SWSEpoch REMEpoch
    for i=1:5
        Delta_M243_RdmTone{a,i}=Restrict(ts(tDelta),EpochAnalysed{i});
        DurSWSEpoch_M243_RdmTone{a,i}=tot_length(and(SWSEpoch,EpochAnalysed{i}),'s');
        DurREMEpoch_M243_RdmTone{a,i}=tot_length(and(REMEpoch,EpochAnalysed{i}),'s');
        Dur5Epoch_M243_RdmTone{a,i}=tot_length(EpochAnalysed{i},'s');
        RatioSWS_M243_RdmTone{a,i}=DurSWSEpoch_M243_RdmTone{a,i}/Dur5Epoch_M243_RdmTone{a,i};
        RatioREM_M243_RdmTone{a,i}=DurREMEpoch_M243_RdmTone{a,i}/Dur5Epoch_M243_RdmTone{a,i};
    end
end

% <><><><><><><><><><><><><><>  Mouse 244 : random tone sleep <><><><><><><><><><><><><><> 
for a=1:length(Path_M244_Rdm)
    cd(Path_M244_Rdm{a})
    res=pwd;
    
    % find Delta triggered session
    try
        load EpochAnalysed
    catch
        load behavResources
        b=1;
        for i=1:length(evt)/2
            textt=evt(i);
            if ~isempty(strfind(evt{i},'Delta'))
                DeltaSession(b)=i;
                b=b+1;
            elseif ~isempty(strfind(evt{i},'Tone'))
                ToneSession(b)=i;
                b=b+1;
            end
        end
        if exist DeltaSession
            EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{DeltaSession(1)}*1E4);
            EpochAnalysed{2}=intervalSet(tpsdeb{DeltaSession(1)}*1E4,tpsfin{DeltaSession(2)}*1E4);
            EpochAnalysed{3}=intervalSet(tpsfin{DeltaSession(1)}*1E4,tpsdeb{DeltaSession(2)}*1E4);
            EpochAnalysed{4}=intervalSet(tpsdeb{DeltaSession(2)}*1E4,tpsfin{DeltaSession(2)}*1E4);
            EpochAnalysed{5}=intervalSet(tpsfin{DeltaSession(2)}*1E4,tpsfin{end}*1E4);
            clear DeltaSession ToneSession
            save EpochAnalysed EpochAnalysed
        elseif exist ToneSession
            EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{ToneSession(1)}*1E4);
            EpochAnalysed{2}=intervalSet(tpsdeb{ToneSession(1)}*1E4,tpsfin{ToneSession(1)}*1E4);
            EpochAnalysed{3}=intervalSet(tpsfin{ToneSession(1)}*1E4,tpsdeb{ToneSession(2)}*1E4);
            EpochAnalysed{4}=intervalSet(tpsdeb{ToneSession(2)}*1E4,tpsfin{ToneSession(2)}*1E4);
            EpochAnalysed{5}=intervalSet(tpsfin{ToneSession(2)}*1E4,tpsfin{end}*1E4);
            clear ToneSession DeltaSession
            save EpochAnalysed EpochAnalysed
        end
    end
    
    % restrict Delta occurence to the 5 succesive Sleep epochs 
    load([res,'/newDelta',struc]);
     load StateEpochSB SWSEpoch REMEpoch
    for i=1:5
        Delta_M244_RdmTone{a,i}=Restrict(ts(tDelta),EpochAnalysed{i});
        DurSWSEpoch_M244_RdmTone{a,i}=tot_length(and(SWSEpoch,EpochAnalysed{i}),'s');
        DurREMEpoch_M244_RdmTone{a,i}=tot_length(and(REMEpoch,EpochAnalysed{i}),'s');
        Dur5Epoch_M244_RdmTone{a,i}=tot_length(EpochAnalysed{i},'s');
        RatioSWS_M244_RdmTone{a,i}=DurSWSEpoch_M244_RdmTone{a,i}/Dur5Epoch_M244_RdmTone{a,i};
        RatioREM_M244_RdmTone{a,i}=DurREMEpoch_M244_RdmTone{a,i}/Dur5Epoch_M244_RdmTone{a,i};
    end
end

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                       LOAD  EPOCH & DELTA for DELTA TONE SLEEP
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

% <><><><><><><><><><><><><><>  Mouse 243 : delta sleep <><><><><><><><><><><><><><> 
for a=1:length(Path_M243_Delta)
    cd(Path_M243_Delta{a})
    res=pwd;
    
    % find Delta triggered session
    load behavResources
    b=1;
    for i=1:length(evt)/2
        textt=evt(i);
       if ~isempty(strfind(evt{i},'Delta'))
            DeltaSession(b)=i;
            b=b+1;
        end
    end
    if length(DeltaSession)==2
        EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{DeltaSession(1)}*1E4);
        EpochAnalysed{2}=intervalSet(tpsdeb{DeltaSession(1)}*1E4,tpsfin{DeltaSession(1)}*1E4);
        EpochAnalysed{3}=intervalSet(tpsfin{DeltaSession(1)}*1E4,tpsdeb{DeltaSession(2)}*1E4);
        EpochAnalysed{4}=intervalSet(tpsdeb{DeltaSession(2)}*1E4,tpsfin{DeltaSession(2)}*1E4);
        EpochAnalysed{5}=intervalSet(tpsfin{DeltaSession(2)}*1E4,tpsfin{end}*1E4);
    end
    if length(DeltaSession)==3
        EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{DeltaSession(1)}*1E4);
        EpochAnalysed{2}=intervalSet(tpsdeb{DeltaSession(1)}*1E4,tpsfin{DeltaSession(2)}*1E4);
        EpochAnalysed{3}=intervalSet(tpsfin{DeltaSession(2)}*1E4,tpsdeb{DeltaSession(3)}*1E4);
        EpochAnalysed{4}=intervalSet(tpsdeb{DeltaSession(3)}*1E4,tpsfin{DeltaSession(3)}*1E4);
        EpochAnalysed{5}=intervalSet(tpsfin{DeltaSession(3)}*1E4,tpsfin{end}*1E4);
    end
    clear DeltaSession
   
    % restrict Delta occurence to the 5 succesive Sleep epochs 
    load([res,'/newDelta',struc]);
    for i=1:5
        Delta_M243_DeltaTone{a,i}=Restrict(ts(tDelta),EpochAnalysed{i});
        DurSWSEpoch_M243_DeltaTone{a,i}=tot_length(and(SWSEpoch,EpochAnalysed{i}),'s');
        DurREMEpoch_M243_DeltaTone{a,i}=tot_length(and(REMEpoch,EpochAnalysed{i}),'s');
        Dur5Epoch_M243_DeltaTone{a,i}=tot_length(EpochAnalysed{i},'s');
        RatioSWS_M243_DeltaTone{a,i}=DurSWSEpoch_M243_DeltaTone{a,i}/Dur5Epoch_M243_DeltaTone{a,i};
        RatioREM_M243_DeltaTone{a,i}=DurREMEpoch_M243_DeltaTone{a,i}/Dur5Epoch_M243_DeltaTone{a,i};
    end
end

% <><><><><><><><><><><><><><>  Mouse 244 : delta sleep <><><><><><><><><><><><><><> 
for a=1:length(Path_M244_Delta)
    cd(Path_M244_Delta{a})
    res=pwd;
    
    % find Delta triggered session
    load behavResources
    b=1;
    for i=1:length(evt)/2
        textt=evt(i);
       if ~isempty(strfind(evt{i},'Delta'))
            DeltaSession(b)=i;
            b=b+1;
        end
    end
    if length(DeltaSession)==2
        EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{DeltaSession(1)}*1E4);
        EpochAnalysed{2}=intervalSet(tpsdeb{DeltaSession(1)}*1E4,tpsfin{DeltaSession(1)}*1E4);
        EpochAnalysed{3}=intervalSet(tpsfin{DeltaSession(1)}*1E4,tpsdeb{DeltaSession(2)}*1E4);
        EpochAnalysed{4}=intervalSet(tpsdeb{DeltaSession(2)}*1E4,tpsfin{DeltaSession(2)}*1E4);
        EpochAnalysed{5}=intervalSet(tpsfin{DeltaSession(2)}*1E4,tpsfin{end}*1E4);
    end
    if length(DeltaSession)==3
        EpochAnalysed{1}=intervalSet(tpsdeb{1}*1E4,tpsdeb{DeltaSession(1)}*1E4);
        EpochAnalysed{2}=intervalSet(tpsdeb{DeltaSession(1)}*1E4,tpsfin{DeltaSession(2)}*1E4);
        EpochAnalysed{3}=intervalSet(tpsfin{DeltaSession(2)}*1E4,tpsdeb{DeltaSession(3)}*1E4);
        EpochAnalysed{4}=intervalSet(tpsdeb{DeltaSession(3)}*1E4,tpsfin{DeltaSession(3)}*1E4);
        EpochAnalysed{5}=intervalSet(tpsfin{DeltaSession(3)}*1E4,tpsfin{end}*1E4);
    end
    clear DeltaSession

   
    % restrict Delta occurence to the 5 succesive Sleep epochs 
    load([res,'/newDelta',struc]);
   for i=1:5
        Delta_M244_DeltaTone{a,i}=Restrict(ts(tDelta),EpochAnalysed{i});
        DurSWSEpoch_M244_DeltaTone{a,i}=tot_length(and(SWSEpoch,EpochAnalysed{i}),'s');
        DurREMEpoch_M244_DeltaTone{a,i}=tot_length(and(REMEpoch,EpochAnalysed{i}),'s');
        Dur5Epoch_M244_DeltaTone{a,i}=tot_length(EpochAnalysed{i},'s');
        RatioSWS_M244_DeltaTone{a,i}=DurSWSEpoch_M244_DeltaTone{a,i}/Dur5Epoch_M244_DeltaTone{a,i};
        RatioREM_M244_DeltaTone{a,i}=DurREMEpoch_M244_DeltaTone{a,i}/Dur5Epoch_M244_DeltaTone{a,i};
    end
end

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                           FIND RHYTHMS and BURST of DELTA
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   DELTA RAW QUANTITY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><>  Basal Sleep <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_basal)
    for j=1:5
        Qdelta_M243_basal(i,j)=length(Delta_M243_basal{i,j});
        Qdelta_M244_basal(i,j)=length(Delta_M244_basal{i,j});
    end
end
% normalized
for i=1:length(Path_M243_basal)
    for j=1:5
        QdeltaNor_M243_basal(i,j)=Qdelta_M243_basal(i,j)./Qdelta_M243_basal(i,1);
        QdeltaNor_M244_basal(i,j)=Qdelta_M244_basal(i,j)./Qdelta_M244_basal(i,1);
    end
end
% mean & normalized
Qdelta_All_basal=(Qdelta_M243_basal./(Qdelta_M243_basal(:,1)*ones(1,5))+Qdelta_M244_basal./(Qdelta_M244_basal(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Rdm Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Rdm)
    for j=1:5
        Qdelta_M243_rdm(i,j)=length(Delta_M243_RdmTone{i,j});
        Qdelta_M244_rdm(i,j)=length(Delta_M244_RdmTone{i,j});
    end
end
Qdelta_M243_rdm(1,1)=2000;
for i=1:length(Path_M243_Rdm)
    for j=1:5
        QdeltaNor_M243_rdm(i,j)=Qdelta_M243_rdm(i,j)./Qdelta_M243_rdm(i,1);
        QdeltaNor_M244_rdm(i,j)=Qdelta_M244_rdm(i,j)./Qdelta_M244_rdm(i,1);
    end
end
% mean & normalized
QdeltaNor_All_rdm=(Qdelta_M243_rdm./(Qdelta_M243_rdm(:,1)*ones(1,5))+Qdelta_M244_rdm./(Qdelta_M244_rdm(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Delta Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Delta)
    for j=1:5
        Qdelta_M243_delta(i,j)=length(Delta_M243_DeltaTone{i,j});
        Qdelta_M244_delta(i,j)=length(Delta_M244_DeltaTone{i,j});
    end
end
for i=1:length(Path_M243_Delta)
    for j=1:5
        QdeltaNor_M243_delta(i,j)=Qdelta_M243_delta(i,j)./Qdelta_M243_delta(i,1);
        QdeltaNor_M244_delta(i,j)=Qdelta_M244_delta(i,j)./Qdelta_M244_delta(i,1);
    end
end
% mean & normalized
QdeltaNor_All_delta=(Qdelta_M243_delta./(Qdelta_M243_delta(:,1)*ones(1,5))+Qdelta_M244_delta./(Qdelta_M244_delta(:,1)*ones(1,5)))/2;


%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                      SWS  QUANTITY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><>  Basal Sleep <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_basal)
    for j=1:5
        QSWS_M243_basal(i,j)=DurSWSEpoch_M243_basal{i,j};
        QSWS_M244_basal(i,j)=DurSWSEpoch_M244_basal{i,j};
    end
end
% normalized
for i=1:length(Path_M243_basal)
    for j=1:5
        QSWSNor_M243_basal(i,j)=QSWS_M243_basal(i,j)./QSWS_M243_basal(i,1);
        QSWSNor_M244_basal(i,j)=QSWS_M244_basal(i,j)./QSWS_M244_basal(i,1);
    end
end
% mean & normalized
QSWS_All_basal=(QSWS_M243_basal./(QSWS_M243_basal(:,1)*ones(1,5))+QSWS_M244_basal./(QSWS_M244_basal(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Rdm Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Rdm)
    for j=1:5
        QSWS_M243_rdm(i,j)=DurSWSEpoch_M243_RdmTone{i,j};
        QSWS_M244_rdm(i,j)=DurSWSEpoch_M244_RdmTone{i,j};
    end
end
for i=1:length(Path_M243_Rdm)
    for j=1:5
        QSWSNor_M243_rdm(i,j)=QSWS_M243_rdm(i,j)./QSWS_M243_rdm(i,1);
        QSWSNor_M244_rdm(i,j)=QSWS_M244_rdm(i,j)./QSWS_M244_rdm(i,1);
    end
end
% mean & normalized
QSWSNor_All_rdm=(QSWS_M243_rdm./(QSWS_M243_rdm(:,1)*ones(1,5))+QSWS_M244_rdm./(QSWS_M244_rdm(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Delta Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Delta)
    for j=1:5
        QSWS_M243_delta(i,j)=DurSWSEpoch_M243_DeltaTone{i,j};
        QSWS_M244_delta(i,j)=DurSWSEpoch_M244_DeltaTone{i,j};
    end
end
for i=1:length(Path_M243_Delta)
    for j=1:5
        QSWSNor_M243_delta(i,j)=QSWS_M243_delta(i,j)./QSWS_M243_delta(i,1);
        QSWSNor_M244_delta(i,j)=QSWS_M244_delta(i,j)./QSWS_M244_delta(i,1);
    end
end
% mean & normalized
QSWSNor_All_delta=(QSWS_M243_delta./(QSWS_M243_delta(:,1)*ones(1,5))+QSWS_M244_delta./(QSWS_M244_delta(:,1)*ones(1,5)))/2;

%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                      SWS  RATIO 
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><>  Basal Sleep <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_basal)
    for j=1:5
        rSWS_M243_basal(i,j)=RatioSWS_M243_basal{i,j};
        rSWS_M244_basal(i,j)=RatioSWS_M244_basal{i,j};
    end
end
% normalized
for i=1:length(Path_M243_basal)
    for j=1:5
        rSWSNor_M243_basal(i,j)=rSWS_M243_basal(i,j)./rSWS_M243_basal(i,1);
        rSWSNor_M244_basal(i,j)=rSWS_M244_basal(i,j)./rSWS_M244_basal(i,1);
    end
end
% mean & normalized
rSWS_All_basal=(rSWS_M243_basal./(rSWS_M243_basal(:,1)*ones(1,5))+rSWS_M244_basal./(rSWS_M244_basal(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Rdm Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Rdm)
    for j=1:5
        rSWS_M243_rdm(i,j)=RatioSWS_M243_RdmTone{i,j};
        rSWS_M244_rdm(i,j)=RatioSWS_M244_RdmTone{i,j};
    end
end
for i=1:length(Path_M243_Rdm)
    for j=1:5
        rSWSNor_M243_rdm(i,j)=rSWS_M243_rdm(i,j)./rSWS_M243_rdm(i,1);
        rSWSNor_M244_rdm(i,j)=rSWS_M244_rdm(i,j)./rSWS_M244_rdm(i,1);
    end
end
% mean & normalized
rSWSNor_All_rdm=(rSWS_M243_rdm./(rSWS_M243_rdm(:,1)*ones(1,5))+rSWS_M244_rdm./(rSWS_M244_rdm(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Delta Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Delta)
    for j=1:5
        rSWS_M243_delta(i,j)=RatioSWS_M243_DeltaTone{i,j};
        rSWS_M244_delta(i,j)=RatioSWS_M244_DeltaTone{i,j};
    end
end
for i=1:length(Path_M243_Delta)
    for j=1:5
        rSWSNor_M243_delta(i,j)=rSWS_M243_delta(i,j)./rSWS_M243_delta(i,1);
        rSWSNor_M244_delta(i,j)=rSWS_M244_delta(i,j)./rSWS_M244_delta(i,1);
    end
end
% mean & normalized
rSWSNor_All_delta=(rSWS_M243_delta./(rSWS_M243_delta(:,1)*ones(1,5))+rSWS_M244_delta./(rSWS_M244_delta(:,1)*ones(1,5)))/2;


%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                      REM  QUANTITY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><>  Basal Sleep <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_basal)
    for j=1:5
        QREM_M243_basal(i,j)=DurREMEpoch_M243_basal{i,j};
        QREM_M244_basal(i,j)=DurREMEpoch_M244_basal{i,j};
    end
end
% normalized
for i=1:length(Path_M243_basal)
    for j=1:5
        QREMNor_M243_basal(i,j)=QREM_M243_basal(i,j)./QREM_M243_basal(i,1);
        QREMNor_M244_basal(i,j)=QREM_M244_basal(i,j)./QREM_M244_basal(i,1);
    end
end
% mean & normalized
QREM_All_basal=(QREM_M243_basal./(QREM_M243_basal(:,1)*ones(1,5))+QREM_M244_basal./(QREM_M244_basal(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Rdm Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Rdm)
    for j=1:5
        QREM_M243_rdm(i,j)=DurREMEpoch_M243_RdmTone{i,j};
        QREM_M244_rdm(i,j)=DurREMEpoch_M244_RdmTone{i,j};
    end
end
for i=1:length(Path_M243_Rdm)
    for j=1:5
        QREMNor_M243_rdm(i,j)=QREM_M243_rdm(i,j)./QREM_M243_rdm(i,1);
        QREMNor_M244_rdm(i,j)=QREM_M244_rdm(i,j)./QREM_M244_rdm(i,1);
    end
end
% mean & normalized
QREMNor_All_rdm=(QREM_M243_rdm./(QREM_M243_rdm(:,1)*ones(1,5))+QREM_M244_rdm./(QREM_M244_rdm(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Delta Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Delta)
    for j=1:5
        QREM_M243_delta(i,j)=DurREMEpoch_M243_DeltaTone{i,j};
        QREM_M244_delta(i,j)=DurREMEpoch_M244_DeltaTone{i,j};
    end
end
for i=1:length(Path_M243_Delta)
    for j=1:5
        QREMNor_M243_delta(i,j)=QREM_M243_delta(i,j)./QREM_M243_delta(i,1);
        QREMNor_M244_delta(i,j)=QREM_M244_delta(i,j)./QREM_M244_delta(i,1);
    end
end
% mean & normalized
QREMNor_All_delta=(QREM_M243_delta./(QREM_M243_delta(:,1)*ones(1,5))+QREM_M244_delta./(QREM_M244_delta(:,1)*ones(1,5)))/2;

%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                     DELTA FREQUENCY  
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><>  Basal Sleep <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_basal)
    for j=1:5
        Fqdelta_M243_basal(i,j)=length(Delta_M243_basal{i,j})/QSWS_M243_basal(i,j);
        Fqdelta_M244_basal(i,j)=length(Delta_M244_basal{i,j})/QSWS_M243_basal(i,j);
    end
end
% normalized
for i=1:length(Path_M243_basal)
    for j=1:5
        FqdeltaNor_M243_basal(i,j)=Fqdelta_M243_basal(i,j)./Fqdelta_M243_basal(i,1);
        FqdeltaNor_M244_basal(i,j)=Fqdelta_M244_basal(i,j)./Fqdelta_M244_basal(i,1);
    end
end
% mean & normalized
Fqdelta_All_basal=(Fqdelta_M243_basal./(Fqdelta_M243_basal(:,1)*ones(1,5))+Fqdelta_M244_basal./(Fqdelta_M244_basal(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Rdm Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Rdm)
    for j=1:5
        Fqdelta_M243_rdm(i,j)=length(Delta_M243_RdmTone{i,j})/QSWS_M243_rdm(i,j);
        Fqdelta_M244_rdm(i,j)=length(Delta_M244_RdmTone{i,j})/QSWS_M243_rdm(i,j);
    end
end
for i=1:length(Path_M243_Rdm)
    for j=1:5
        FqdeltaNor_M243_rdm(i,j)=Fqdelta_M243_rdm(i,j)./Fqdelta_M243_rdm(i,1);
        FqdeltaNor_M244_rdm(i,j)=Fqdelta_M244_rdm(i,j)./Fqdelta_M244_rdm(i,1);
    end
end
% mean & normalized
FqdeltaNor_All_rdm=(Fqdelta_M243_rdm./(Fqdelta_M243_rdm(:,1)*ones(1,5))+Fqdelta_M244_rdm./(Fqdelta_M244_rdm(:,1)*ones(1,5)))/2;

% <><><><><><><><><><><><>  Delta Tone Sleep  <><><><><><><><><><><><><><> 
for i=1:length(Path_M243_Delta)
    for j=1:5
        Fqdelta_M243_delta(i,j)=length(Delta_M243_DeltaTone{i,j})/QSWS_M243_delta(i,j);
        Fqdelta_M244_delta(i,j)=length(Delta_M244_DeltaTone{i,j})/QSWS_M243_delta(i,j);
    end
end
for i=1:length(Path_M243_Delta)
    for j=1:5
        FqdeltaNor_M243_delta(i,j)=Fqdelta_M243_delta(i,j)./Fqdelta_M243_delta(i,1);
        FqdeltaNor_M244_delta(i,j)=Fqdelta_M244_delta(i,j)./Fqdelta_M244_delta(i,1);
    end
end
% mean & normalized
FqdeltaNor_All_delta=(Fqdelta_M243_delta./(Fqdelta_M243_delta(:,1)*ones(1,5))+Fqdelta_M244_delta./(Fqdelta_M244_delta(:,1)*ones(1,5)))/2;




% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                           PLOT ALL THAT
%---------------------------------------------------------------------------------------------------------------------------------------------------
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>


%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   DELTA RAW QUANTITY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
figure('color',[1 1 1]), 
hold on, subplot(2,2,1)
hold on, PlotErrorBarN(Qdelta_M243_basal,0)
hold on, plot(1:5,Qdelta_M243_delta(1,:),'go-')
hold on, plot(1:5,Qdelta_M243_delta(2,:),'co-')
hold on, plot(1:5,Qdelta_M243_delta(3,:),'bo-')
hold on, plot(1:5,Qdelta_M243_delta(4,:),'mo-')
hold on, plot(1:5,Qdelta_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(2,2,2)
hold on, PlotErrorBarN(Qdelta_M243_basal,0)
hold on, plot(1:5,Qdelta_M243_rdm(1,:),'go-')
hold on, plot(1:5,Qdelta_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(2,2,3)
hold on, PlotErrorBarN(Qdelta_M244_basal,0)
hold on, plot(1:5,Qdelta_M244_delta(1,:),'go-')
hold on, plot(1:5,Qdelta_M244_delta(2,:),'co-')
hold on, plot(1:5,Qdelta_M244_delta(3,:),'bo-')
hold on, plot(1:5,Qdelta_M244_delta(4,:),'mo-')
hold on, plot(1:5,Qdelta_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(2,2,4)
hold on, PlotErrorBarN(Qdelta_M244_basal,0)
hold on, plot(1:5,Qdelta_M244_rdm(1,:),'go-')
hold on, plot(1:5,Qdelta_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - Delta Quantity Basal vs DeltaTone')

figure('color',[1 1 1]), 
hold on, subplot(3,2,1)
hold on, PlotErrorBarN(QdeltaNor_M243_basal,0)
hold on, plot(1:5,QdeltaNor_M243_delta(1,:),'go-')
hold on, plot(1:5,QdeltaNor_M243_delta(2,:),'co-')
hold on, plot(1:5,QdeltaNor_M243_delta(3,:),'bo-')
hold on, plot(1:5,QdeltaNor_M243_delta(4,:),'mo-')
hold on, plot(1:5,QdeltaNor_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(3,2,2)
hold on, PlotErrorBarN(QdeltaNor_M243_basal,0)
hold on, plot(1:5,QdeltaNor_M243_rdm(1,:),'go-')
hold on, plot(1:5,QdeltaNor_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(3,2,3)
hold on, PlotErrorBarN(QdeltaNor_M244_basal,0)
hold on, plot(1:5,QdeltaNor_M244_delta(1,:),'go-')
hold on, plot(1:5,QdeltaNor_M244_delta(2,:),'co-')
hold on, plot(1:5,QdeltaNor_M244_delta(3,:),'bo-')
hold on, plot(1:5,QdeltaNor_M244_delta(4,:),'mo-')
hold on, plot(1:5,QdeltaNor_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(3,2,4)
hold on, PlotErrorBarN(QdeltaNor_M244_basal,0)
hold on, plot(1:5,QdeltaNor_M244_rdm(1,:),'go-')
hold on, plot(1:5,QdeltaNor_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - Delta Quantity Basal vs DeltaTone')
hold on, subplot(3,2,5)
hold on, PlotErrorBarN(QdeltaNor_All_basal,0)
hold on, plot(1:5,QdeltaNor_All_delta(1,:),'go-')
hold on, plot(1:5,QdeltaNor_All_delta(2,:),'co-')
hold on, plot(1:5,QdeltaNor_All_delta(3,:),'bo-')
hold on, plot(1:5,QdeltaNor_All_delta(4,:),'mo-')
hold on, plot(1:5,QdeltaNor_All_delta(5,:),'ro-')
hold on, title('Delta Quantity Basal vs DeltaTone')
hold on, subplot(3,2,6)
hold on, PlotErrorBarN(QdeltaNor_All_basal,0)
hold on, plot(1:5,QdeltaNor_All_rdm(1,:),'go-')
hold on, plot(1:5,QdeltaNor_All_rdm(2,:),'co-')
hold on, title('Delta Quantity Basal vs DeltaTone')

%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   DELTA FREQUENCY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
figure('color',[1 1 1]), 
hold on, subplot(2,2,1)
hold on, PlotErrorBarN(Fqdelta_M243_basal,0)
hold on, plot(1:5,Fqdelta_M243_delta(1,:),'go-')
hold on, plot(1:5,Fqdelta_M243_delta(2,:),'co-')
hold on, plot(1:5,Fqdelta_M243_delta(3,:),'bo-')
hold on, plot(1:5,Fqdelta_M243_delta(4,:),'mo-')
hold on, plot(1:5,Fqdelta_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(2,2,2)
hold on, PlotErrorBarN(Fqdelta_M243_basal,0)
hold on, plot(1:5,Fqdelta_M243_rdm(1,:),'go-')
hold on, plot(1:5,Fqdelta_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(2,2,3)
hold on, PlotErrorBarN(Fqdelta_M244_basal,0)
hold on, plot(1:5,Fqdelta_M244_delta(1,:),'go-')
hold on, plot(1:5,Fqdelta_M244_delta(2,:),'co-')
hold on, plot(1:5,Fqdelta_M244_delta(3,:),'bo-')
hold on, plot(1:5,Fqdelta_M244_delta(4,:),'mo-')
hold on, plot(1:5,Fqdelta_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(2,2,4)
hold on, PlotErrorBarN(Fqdelta_M244_basal,0)
hold on, plot(1:5,Fqdelta_M244_rdm(1,:),'go-')
hold on, plot(1:5,Fqdelta_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - Delta Frequency Basal vs DeltaTone')

figure('color',[1 1 1]), 
hold on, subplot(3,2,1)
hold on, PlotErrorBarN(FqdeltaNor_M243_basal,0)
hold on, plot(1:5,FqdeltaNor_M243_delta(1,:),'go-')
hold on, plot(1:5,FqdeltaNor_M243_delta(2,:),'co-')
hold on, plot(1:5,FqdeltaNor_M243_delta(3,:),'bo-')
hold on, plot(1:5,FqdeltaNor_M243_delta(4,:),'mo-')
hold on, plot(1:5,FqdeltaNor_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(3,2,2)
hold on, PlotErrorBarN(FqdeltaNor_M243_basal,0)
hold on, plot(1:5,FqdeltaNor_M243_rdm(1,:),'go-')
hold on, plot(1:5,FqdeltaNor_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(3,2,3)
hold on, PlotErrorBarN(FqdeltaNor_M244_basal,0)
hold on, plot(1:5,FqdeltaNor_M244_delta(1,:),'go-')
hold on, plot(1:5,FqdeltaNor_M244_delta(2,:),'co-')
hold on, plot(1:5,FqdeltaNor_M244_delta(3,:),'bo-')
hold on, plot(1:5,FqdeltaNor_M244_delta(4,:),'mo-')
hold on, plot(1:5,FqdeltaNor_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(3,2,4)
hold on, PlotErrorBarN(FqdeltaNor_M244_basal,0)
hold on, plot(1:5,FqdeltaNor_M244_rdm(1,:),'go-')
hold on, plot(1:5,FqdeltaNor_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - Delta Frequency Basal vs DeltaTone')
hold on, subplot(3,2,5)
hold on, PlotErrorBarN(FqdeltaNor_All_basal,0)
hold on, plot(1:5,FqdeltaNor_All_delta(1,:),'go-')
hold on, plot(1:5,FqdeltaNor_All_delta(2,:),'co-')
hold on, plot(1:5,FqdeltaNor_All_delta(3,:),'bo-')
hold on, plot(1:5,FqdeltaNor_All_delta(4,:),'mo-')
hold on, plot(1:5,FqdeltaNor_All_delta(5,:),'ro-')
hold on, title('Delta Frequency Basal vs DeltaTone')
hold on, subplot(3,2,6)
hold on, PlotErrorBarN(FqdeltaNor_All_basal,0)
hold on, plot(1:5,FqdeltaNor_All_rdm(1,:),'go-')
hold on, plot(1:5,FqdeltaNor_All_rdm(2,:),'co-')
hold on, title('Delta Frequency Basal vs DeltaTone')


%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   SWS QUANTITY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
figure('color',[1 1 1]), 
hold on, subplot(2,2,1)
hold on, PlotErrorBarN(QSWS_M243_basal,0)
hold on, plot(1:5,QSWS_M243_delta(1,:),'go-')
hold on, plot(1:5,QSWS_M243_delta(2,:),'co-')
hold on, plot(1:5,QSWS_M243_delta(3,:),'bo-')
hold on, plot(1:5,QSWS_M243_delta(4,:),'mo-')
hold on, plot(1:5,QSWS_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(2,2,2)
hold on, PlotErrorBarN(QSWS_M243_basal,0)
hold on, plot(1:5,QSWS_M243_rdm(1,:),'go-')
hold on, plot(1:5,QSWS_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(2,2,3)
hold on, PlotErrorBarN(QSWS_M244_basal,0)
hold on, plot(1:5,QSWS_M244_delta(1,:),'go-')
hold on, plot(1:5,QSWS_M244_delta(2,:),'co-')
hold on, plot(1:5,QSWS_M244_delta(3,:),'bo-')
hold on, plot(1:5,QSWS_M244_delta(4,:),'mo-')
hold on, plot(1:5,QSWS_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(2,2,4)
hold on, PlotErrorBarN(QSWS_M244_basal,0)
hold on, plot(1:5,QSWS_M244_rdm(1,:),'go-')
hold on, plot(1:5,QSWS_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - SWS Quantity Basal vs DeltaTone')

figure('color',[1 1 1]), 
hold on, subplot(3,2,1)
hold on, PlotErrorBarN(QSWSNor_M243_basal,0)
hold on, plot(1:5,QSWSNor_M243_delta(1,:),'go-')
hold on, plot(1:5,QSWSNor_M243_delta(2,:),'co-')
hold on, plot(1:5,QSWSNor_M243_delta(3,:),'bo-')
hold on, plot(1:5,QSWSNor_M243_delta(4,:),'mo-')
hold on, plot(1:5,QSWSNor_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(3,2,2)
hold on, PlotErrorBarN(QSWSNor_M243_basal,0)
hold on, plot(1:5,QSWSNor_M243_rdm(1,:),'go-')
hold on, plot(1:5,QSWSNor_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(3,2,3)
hold on, PlotErrorBarN(QSWSNor_M244_basal,0)
hold on, plot(1:5,QSWSNor_M244_delta(1,:),'go-')
hold on, plot(1:5,QSWSNor_M244_delta(2,:),'co-')
hold on, plot(1:5,QSWSNor_M244_delta(3,:),'bo-')
hold on, plot(1:5,QSWSNor_M244_delta(4,:),'mo-')
hold on, plot(1:5,QSWSNor_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(3,2,4)
hold on, PlotErrorBarN(QSWSNor_M244_basal,0)
hold on, plot(1:5,QSWSNor_M244_rdm(1,:),'go-')
hold on, plot(1:5,QSWSNor_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - SWS Quantity Basal vs DeltaTone')
hold on, subplot(3,2,5)
hold on, PlotErrorBarN(QSWS_All_basal,0)
hold on, plot(1:5,QSWSNor_All_delta(1,:),'go-')
hold on, plot(1:5,QSWSNor_All_delta(2,:),'co-')
hold on, plot(1:5,QSWSNor_All_delta(3,:),'bo-')
hold on, plot(1:5,QSWSNor_All_delta(4,:),'mo-')
hold on, plot(1:5,QSWSNor_All_delta(5,:),'ro-')
hold on, title('SWS Quantity Basal vs DeltaTone')
hold on, subplot(3,2,6)
hold on, PlotErrorBarN(QSWS_All_basal,0)
hold on, plot(1:5,QSWSNor_All_rdm(1,:),'go-')
hold on, plot(1:5,QSWSNor_All_rdm(2,:),'co-')
hold on, title('SWS Quantity Basal vs DeltaTone')

%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   REM QUANTITY 
%---------------------------------------------------------------------------------------------------------------------------------------------------
figure('color',[1 1 1]), 
hold on, subplot(2,2,1)
hold on, PlotErrorBarN(QREM_M243_basal,0)
hold on, plot(1:5,QREM_M243_delta(1,:),'go-')
hold on, plot(1:5,QREM_M243_delta(2,:),'co-')
hold on, plot(1:5,QREM_M243_delta(3,:),'bo-')
hold on, plot(1:5,QREM_M243_delta(4,:),'mo-')
hold on, plot(1:5,QREM_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - REM Quantity Basal vs DeltaTone')
hold on, subplot(2,2,2)
hold on, PlotErrorBarN(QREM_M243_basal,0)
hold on, plot(1:5,QREM_M243_rdm(1,:),'go-')
hold on, plot(1:5,QREM_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - REM Quantity Basal vs DeltaTone')
hold on, subplot(2,2,3)
hold on, PlotErrorBarN(QREM_M244_basal,0)
hold on, plot(1:5,QREM_M244_delta(1,:),'go-')
hold on, plot(1:5,QREM_M244_delta(2,:),'co-')
hold on, plot(1:5,QREM_M244_delta(3,:),'bo-')
hold on, plot(1:5,QREM_M244_delta(4,:),'mo-')
hold on, plot(1:5,QREM_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - REM Quantity Basal vs DeltaTone')
hold on, subplot(2,2,4)
hold on, PlotErrorBarN(QREM_M244_basal,0)
hold on, plot(1:5,QREM_M244_rdm(1,:),'go-')
hold on, plot(1:5,QREM_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - REM Quantity Basal vs DeltaTone')

figure('color',[1 1 1]), 
hold on, subplot(3,2,1)
hold on, PlotErrorBarN(QREMNor_M243_basal,0)
hold on, plot(1:5,QREMNor_M243_delta(1,:),'go-')
hold on, plot(1:5,QREMNor_M243_delta(2,:),'co-')
hold on, plot(1:5,QREMNor_M243_delta(3,:),'bo-')
hold on, plot(1:5,QREMNor_M243_delta(4,:),'mo-')
hold on, plot(1:5,QREMNor_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - REM Quantity Basal vs DeltaTone')
hold on, subplot(3,2,2)
hold on, PlotErrorBarN(QREMNor_M243_basal,0)
hold on, plot(1:5,QREMNor_M243_rdm(1,:),'go-')
hold on, plot(1:5,QREMNor_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - REM Quantity Basal vs DeltaTone')
hold on, subplot(3,2,3)
hold on, PlotErrorBarN(QREMNor_M244_basal,0)
hold on, plot(1:5,QREMNor_M244_delta(1,:),'go-')
hold on, plot(1:5,QREMNor_M244_delta(2,:),'co-')
hold on, plot(1:5,QREMNor_M244_delta(3,:),'bo-')
hold on, plot(1:5,QREMNor_M244_delta(4,:),'mo-')
hold on, plot(1:5,QREMNor_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - REM Quantity Basal vs DeltaTone')
hold on, subplot(3,2,4)
hold on, PlotErrorBarN(QREMNor_M244_basal,0)
hold on, plot(1:5,QREMNor_M244_rdm(1,:),'go-')
hold on, plot(1:5,QREMNor_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - REM Quantity Basal vs DeltaTone')
hold on, subplot(3,2,5)
hold on, PlotErrorBarN(QREM_All_basal,0)
hold on, plot(1:5,QREMNor_All_delta(1,:),'go-')
hold on, plot(1:5,QREMNor_All_delta(2,:),'co-')
hold on, plot(1:5,QREMNor_All_delta(3,:),'bo-')
hold on, plot(1:5,QREMNor_All_delta(4,:),'mo-')
hold on, plot(1:5,QREMNor_All_delta(5,:),'ro-')
hold on, title('REM Quantity Basal vs DeltaTone')
hold on, subplot(3,2,6)
hold on, PlotErrorBarN(QREM_All_basal,0)
hold on, plot(1:5,QREMNor_All_rdm(1,:),'go-')
hold on, plot(1:5,QREMNor_All_rdm(2,:),'co-')
hold on, title('REM Quantity Basal vs DeltaTone')

%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   SWS RATIO 
%---------------------------------------------------------------------------------------------------------------------------------------------------
figure('color',[1 1 1]), 
hold on, subplot(2,2,1)
hold on, PlotErrorBarN(rSWS_M243_basal,0)
hold on, plot(1:5,rSWS_M243_delta(1,:),'go-')
hold on, plot(1:5,rSWS_M243_delta(2,:),'co-')
hold on, plot(1:5,rSWS_M243_delta(3,:),'bo-')
hold on, plot(1:5,rSWS_M243_delta(4,:),'mo-')
hold on, plot(1:5,rSWS_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(2,2,2)
hold on, PlotErrorBarN(rSWS_M243_basal,0)
hold on, plot(1:5,rSWS_M243_rdm(1,:),'go-')
hold on, plot(1:5,rSWS_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(2,2,3)
hold on, PlotErrorBarN(rSWS_M244_basal,0)
hold on, plot(1:5,rSWS_M244_delta(1,:),'go-')
hold on, plot(1:5,rSWS_M244_delta(2,:),'co-')
hold on, plot(1:5,rSWS_M244_delta(3,:),'bo-')
hold on, plot(1:5,rSWS_M244_delta(4,:),'mo-')
hold on, plot(1:5,rSWS_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(2,2,4)
hold on, PlotErrorBarN(rSWS_M244_basal,0)
hold on, plot(1:5,rSWS_M244_rdm(1,:),'go-')
hold on, plot(1:5,rSWS_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - SWS Ratio Basal vs DeltaTone')

figure('color',[1 1 1]), 
hold on, subplot(3,2,1)
hold on, PlotErrorBarN(rSWSNor_M243_basal,0)
hold on, plot(1:5,rSWSNor_M243_delta(1,:),'go-')
hold on, plot(1:5,rSWSNor_M243_delta(2,:),'co-')
hold on, plot(1:5,rSWSNor_M243_delta(3,:),'bo-')
hold on, plot(1:5,rSWSNor_M243_delta(4,:),'mo-')
hold on, plot(1:5,rSWSNor_M243_delta(5,:),'ro-')
hold on, title('Mouse 243 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(3,2,2)
hold on, PlotErrorBarN(rSWSNor_M243_basal,0)
hold on, plot(1:5,rSWSNor_M243_rdm(1,:),'go-')
hold on, plot(1:5,rSWSNor_M243_rdm(2,:),'co-')
hold on, title('Mouse 243 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(3,2,3)
hold on, PlotErrorBarN(rSWSNor_M244_basal,0)
hold on, plot(1:5,rSWSNor_M244_delta(1,:),'go-')
hold on, plot(1:5,rSWSNor_M244_delta(2,:),'co-')
hold on, plot(1:5,rSWSNor_M244_delta(3,:),'bo-')
hold on, plot(1:5,rSWSNor_M244_delta(4,:),'mo-')
hold on, plot(1:5,rSWSNor_M244_delta(5,:),'ro-')
hold on, title('Mouse 244 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(3,2,4)
hold on, PlotErrorBarN(rSWSNor_M244_basal,0)
hold on, plot(1:5,rSWSNor_M244_rdm(1,:),'go-')
hold on, plot(1:5,rSWSNor_M244_rdm(2,:),'co-')
hold on, title('Mouse 244 - SWS Ratio Basal vs DeltaTone')
hold on, subplot(3,2,5)
hold on, PlotErrorBarN(rSWS_All_basal,0)
hold on, plot(1:5,rSWSNor_All_delta(1,:),'go-')
hold on, plot(1:5,rSWSNor_All_delta(2,:),'co-')
hold on, plot(1:5,rSWSNor_All_delta(3,:),'bo-')
hold on, plot(1:5,rSWSNor_All_delta(4,:),'mo-')
hold on, plot(1:5,rSWSNor_All_delta(5,:),'ro-')
hold on, title('SWS Ratio Basal vs DeltaTone')
hold on, subplot(3,2,6)
hold on, PlotErrorBarN(rSWS_All_basal,0)
hold on, plot(1:5,rSWSNor_All_rdm(1,:),'go-')
hold on, plot(1:5,rSWSNor_All_rdm(2,:),'co-')
hold on, title('SWS Ratio Basal vs DeltaTone')

%---------------------------------------------------------------------------------------------------------------------------------------------------
%                                                                   CORRELATION 
%---------------------------------------------------------------------------------------------------------------------------------------------------

% Delta Quantity Correlation (mean & normalized)
figure('color',[1 1 1]), 
subplot(3,2,1)
plot(Qdelta_M243_delta(:,1),Qdelta_M243_delta(:,2)-Qdelta_M243_delta(:,1),'ko','markerfacecolor','k')
hold on, plot(Qdelta_M244_delta(:,1),Qdelta_M244_delta(:,2)-Qdelta_M244_delta(:,1),'ro','markerfacecolor','r')
xlim([1000 5000]), ylim([-2000 2000])
subplot(3,2,2)
plot(Qdelta_M243_basal(:,1),Qdelta_M243_basal(:,2)-Qdelta_M243_basal(:,1),'bo','markerfacecolor','b')
hold on, plot(Qdelta_M244_basal(:,1),Qdelta_M244_basal(:,2)-Qdelta_M244_basal(:,1),'mo','markerfacecolor','m')
xlim([1000 5000]), ylim([-2000 2000])

subplot(3,2,3), plot(Qdelta_M243_delta(:,3),Qdelta_M243_delta(:,4)-Qdelta_M243_delta(:,3),'ko','markerfacecolor','k')
hold on, plot(Qdelta_M244_delta(:,3),Qdelta_M244_delta(:,4)-Qdelta_M244_delta(:,3),'ro','markerfacecolor','r')
xlim([1000 5000]), ylim([-2000 2000])
subplot(3,2,4)
plot(Qdelta_M243_basal(:,3),Qdelta_M243_basal(:,4)-Qdelta_M243_basal(:,3),'bo','markerfacecolor','b')
hold on, plot(Qdelta_M244_basal(:,3),Qdelta_M244_basal(:,4)-Qdelta_M244_basal(:,3),'mo','markerfacecolor','m')
xlim([1000 5000]), ylim([-2000 2000])

subplot(3,2,5), plot(Qdelta_M243_delta(:,1),Qdelta_M243_delta(:,4)-Qdelta_M243_delta(:,3),'ko','markerfacecolor','k')
hold on, plot(Qdelta_M244_delta(:,1),Qdelta_M244_delta(:,4)-Qdelta_M244_delta(:,3),'ro','markerfacecolor','r')
xlim([1000 5000]), ylim([-2000 2000])
subplot(3,2,6)
plot(Qdelta_M243_basal(:,1),Qdelta_M243_basal(:,4)-Qdelta_M243_basal(:,3),'bo','markerfacecolor','b')
hold on, plot(Qdelta_M244_basal(:,1),Qdelta_M244_basal(:,4)-Qdelta_M244_basal(:,3),'mo','markerfacecolor','m')
xlim([1000 5000]), ylim([-2000 2000])

% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>

% Delta Quantity Correlation (mean & normalized)
figure('color',[1 1 1]), 
subplot(3,2,1)
plot(Fqdelta_M243_delta(:,1),Fqdelta_M243_delta(:,2)-Fqdelta_M243_delta(:,1),'ko','markerfacecolor','k')
hold on, plot(Fqdelta_M244_delta(:,1),Fqdelta_M244_delta(:,2)-Fqdelta_M244_delta(:,1),'ro','markerfacecolor','r')
subplot(3,2,2)
plot(Fqdelta_M243_basal(:,1),Fqdelta_M243_basal(:,2)-Fqdelta_M243_basal(:,1),'bo','markerfacecolor','b')
hold on, plot(Fqdelta_M244_basal(:,1),Fqdelta_M244_basal(:,2)-Fqdelta_M244_basal(:,1),'mo','markerfacecolor','m')

subplot(3,2,3), plot(Fqdelta_M243_delta(:,3),Fqdelta_M243_delta(:,4)-Fqdelta_M243_delta(:,3),'ko','markerfacecolor','k')
hold on, plot(Fqdelta_M244_delta(:,3),Fqdelta_M244_delta(:,4)-Fqdelta_M244_delta(:,3),'ro','markerfacecolor','r')
subplot(3,2,4)
plot(Fqdelta_M243_basal(:,3),Fqdelta_M243_basal(:,4)-Fqdelta_M243_basal(:,3),'bo','markerfacecolor','b')
hold on, plot(Fqdelta_M244_basal(:,3),Fqdelta_M244_basal(:,4)-Fqdelta_M244_basal(:,3),'mo','markerfacecolor','m')

subplot(3,2,5), plot(Fqdelta_M243_delta(:,1),Fqdelta_M243_delta(:,4)-Fqdelta_M243_delta(:,3),'ko','markerfacecolor','k')
hold on, plot(Fqdelta_M244_delta(:,1),Fqdelta_M244_delta(:,4)-Fqdelta_M244_delta(:,3),'ro','markerfacecolor','r')
subplot(3,2,6)
plot(Fqdelta_M243_basal(:,1),Fqdelta_M243_basal(:,4)-Fqdelta_M243_basal(:,3),'bo','markerfacecolor','b')
hold on, plot(Fqdelta_M244_basal(:,1),Fqdelta_M244_basal(:,4)-Fqdelta_M244_basal(:,3),'mo','markerfacecolor','m')



% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
% <><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>