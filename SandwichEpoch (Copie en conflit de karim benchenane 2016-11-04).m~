function NewEpoch=SandwichEpoch(Epoch1,Epoch2,minin,minout)
%  NewEpoch=SandwichEpoch(Epoch1,Epoch2,maxin,minout)
% NewEpoch contains the elements of Epoch1 shorter than minin that are
% sandwiched between elements of EPoch2 longer than minout

% get rid of too long elements
lengthind=(Stop(Epoch1)-Start(Epoch1))>minin;
NewEpoch=Epoch1-subset(Epoch1,lengthind);
bef2=Stop(Epoch2);
aft2=Start(Epoch2);
bef1=Stop(ShortEpoch);
aft1=Start(ShortEpoch);

for j=1:length(Start(ShortEpoch))
  if(sum(aft1(j)==bef2) +sum(bef1(j)==aft2))==2
    ind1=find((aft1(j)==bef2));
    ind2=find(bef1(j)==aft2);
    long1=(Stop(subset(Epoch1,ind1))-Start(subset(Epoch1,ind1)))>minout;
    long2=(Stop(subset(Epoch1,ind2))-Start(subset(Epoch1,ind2)))>minout;

    if long1 & long2
        NewEpoch=Or(NewEpoch,intervalSet(aft1(j),bef1(j)));
    end
        
    end
      
  end
end
    





end